From c5b23cbf2119540725e6dc81f4deb25798ead6a4 Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Mon, 6 Mar 2023 15:26:32 -0500
Subject: [PATCH] erecursion detection

[anmolja: resolved hunk failures caused by line number mismatches]
Signed-off-by: Anmol Jain <anmolja@vmware.com>

---
 MagickCore/draw.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/MagickCore/draw.c b/MagickCore/draw.c
index 87ebfa1..0416cc9 100644
--- a/MagickCore/draw.c
+++ b/MagickCore/draw.c
@@ -5525,7 +5525,8 @@ MagickExport MagickBooleanType DrawPrimitive(Image *image,

       if (primitive_info->text == (char *) NULL)
         break;
-      clone_info=CloneImageInfo(draw_info->image_info);
+      clone_info=AcquireImageInfo();
+      clone_info->recursion_depth=draw_info->image_info->recursion_depth;
       composite_images=(Image *) NULL;
       if (LocaleNCompare(primitive_info->text,"data:",5) == 0)
         composite_images=ReadInlineImage(clone_info,primitive_info->text,
--
2.35.6

