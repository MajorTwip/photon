From 1e7de9b99c2c7a2e977c4abecd58c84858d609c1 Mon Sep 17 00:00:00 2001
From: Ashwin Dayanand Kamat <kashwindayan@vmware.com>
Date: Fri, 26 May 2023 04:15:45 +0000
Subject: [PATCH] cups : Fix for CVE-2023-32324

Prevent the heap buffer overflow vulnerability which
would allow a remote attacker to lauch a dos attack.

Signed-off by: Ashwin Dayanand Kamat <kashwindayan@vmware.com>
---
 cups/string.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/cups/string.c b/cups/string.c
index 0d4ed0f..40ddda6 100644
--- a/cups/string.c
+++ b/cups/string.c
@@ -1,6 +1,7 @@
 /*
  * String functions for CUPS.
  *
+ * Copyright Â© 2023 by OpenPrinting.
  * Copyright 2007-2014 by Apple Inc.
  * Copyright 1997-2007 by Easy Software Products.
  *
@@ -734,6 +735,8 @@ _cups_strlcpy(char       *dst,		/* O - Destination string */
 {
   size_t	srclen;			/* Length of source string */
 
+  if (size == 0)
+    return (0);
 
  /*
   * Figure out how much room is needed...
-- 
2.39.0

