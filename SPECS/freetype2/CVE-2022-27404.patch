src/sfnt/sfwoff2.c is not present in freetype2 - 2.7.1. Hence only taken changes for src/sfnt/sfobjs.c

From 63765a8f2af9d379f5571c359fb7133b35878924 Mon Sep 17 00:00:00 2001
From: Werner Lemberg <wl@gnu.org>
Date: Sun, 1 Jan 2017 10:43:41 +0100
Subject: [PATCH] [sfnt] Return correct number of named instances for TTCs.

Without this patch, requesting information for face index N returned
the data for face index N+1 (or index 0).

* src/sfnt/sfobjs.c (sfnt_init_face): Correctly adjust `face_index'
for negative `face_instance_index' values.
---
 ChangeLog         | 10 ++++++++++
 src/sfnt/sfobjs.c |  4 ++++
 2 files changed, 14 insertions(+)

From 53dfdcd8198d2b3201a23c4bad9190519ba918db Mon Sep 17 00:00:00 2001
From: Werner Lemberg <wl@gnu.org>
Date: Thu, 17 Mar 2022 19:24:16 +0100
Subject: [PATCH] [sfnt] Avoid invalid face index.

Fixes #1138.

* src/sfnt/sfobjs.c (sfnt_init_face), src/sfnt/sfwoff2.c (woff2_open_font):
Check `face_index` before decrementing.
---
 src/sfnt/sfobjs.c  | 2 +-
 src/sfnt/sfwoff2.c | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)


--- a/src/sfnt/sfobjs.c	2022-05-06 12:59:49.974500406 +0530
+++ b/src/sfnt/sfobjs.c	2022-05-06 13:00:42.150502911 +0530
@@ -909,6 +909,10 @@
 
     face_index = FT_ABS( face_instance_index ) & 0xFFFF;
 
+    /* value -(N+1) requests information on index N */
+    if ( face_instance_index < 0 && face_index > 0 )
+      face_index--;
+
     if ( face_index >= face->ttc_header.count )
     {
       if ( face_instance_index >= 0 )
