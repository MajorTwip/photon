From 32af00b05a6ef573d0b340f97b54c13eb9509dc7 Mon Sep 17 00:00:00 2001
From: Pedro Monreal <pmgdeb@gmail.com>
Date: Thu, 6 Dec 2018 12:18:38 +0100
Subject: [PATCH] CVE-2018-19519 buffer overread. Initialize buf in
 print-hncp.c:print_prefix.

---
 print-hncp.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/print-hncp.c b/print-hncp.c
index 37c13ec3..869268c1 100644
--- a/print-hncp.c
+++ b/print-hncp.c
@@ -207,6 +207,8 @@ print_prefix(netdissect_options *ndo, const u_char *prefix, u_int max_length)
     int plenbytes;
     char buf[sizeof("xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx::/128")];

+    buf[0] = '\0';
+
     if (GET_U_1(prefix) >= 96 && max_length >= IPV4_MAPPED_HEADING_LEN + 1 &&
         is_ipv4_mapped_address(prefix + 1)) {
         nd_ipv4 addr;
